{"version":3,"file":"typescript-api-platform.es5.js","sources":["../src/model/IdData.ts","../src/model/AbstractData.ts","../src/model/Message.ts","../src/function/configureCancel.ts","../src/function/configurePage.ts","../src/function/createPropsParams.ts","../src/resource/AbstractResource.ts","../src/resource/AbstractApiResource.ts","../src/resource/AbstractGetEntityResource.ts","../src/resource/AbstractEntityResource.ts","../src/resource/AbstractDataResource.ts","../src/resource/DefaultDataResource.ts","../src/typescript-api-platform.ts"],"sourcesContent":["export default class IdData<T> {\r\n  id?: T | null = null\r\n}\r\n","import IdData from './IdData'\r\n\r\nexport default class AbstractData extends IdData<number> {}\r\n","export default class Message {\r\n  message?: string | null = null\r\n}\r\n","import { AxiosRequestConfig, CancelTokenSource } from 'axios'\r\n\r\nexport default function configureCancel(\r\n  cancelTokenSource?: CancelTokenSource,\r\n  config?: AxiosRequestConfig\r\n) {\r\n  if (!cancelTokenSource) {\r\n    return config\r\n  }\r\n\r\n  if (!config) {\r\n    config = {}\r\n  }\r\n\r\n  config.cancelToken = cancelTokenSource.token\r\n  return config\r\n}\r\n","import Page from '../model/Page'\r\nimport { AxiosRequestConfig } from 'axios'\r\n\r\nexport default function configurePage(page?: Page, config?: AxiosRequestConfig) {\r\n  if (!page) {\r\n    return config\r\n  }\r\n\r\n  if (!config) {\r\n    config = {}\r\n  }\r\n\r\n  if (!config.headers) {\r\n    config.headers = {}\r\n  }\r\n\r\n  config.headers['Pagination-Page'] = page.page\r\n  config.headers['Pagination-ItemsPerPage'] = page.itemsPerPage\r\n\r\n  return config\r\n}\r\n","export default function createPropsParams(props: string[]): string {\r\n  const params: Set<string> = new Set<string>()\r\n\r\n  for (const prop of props) {\r\n    const path = prop.split('.')\r\n    let i = 0\r\n    let param = 'props'\r\n    while (i < path.length) {\r\n      if (i === path.length - 1) {\r\n        if (path[i] === '*') {\r\n          param += '=true'\r\n        } else {\r\n          param += `[]=${path[i]}`\r\n        }\r\n      } else {\r\n        param += `[${path[i]}]`\r\n      }\r\n      i++\r\n    }\r\n    params.add(param)\r\n  }\r\n  return Array.from(params).join('&')\r\n}\r\n","import { AxiosInstance, AxiosPromise, AxiosResponse } from 'axios'\r\n\r\n/**\r\n * The basic comportment of a resource which access an API\r\n *\r\n * The Axios response stay available using the property `$axios`\r\n */\r\nexport default abstract class AbstractResource {\r\n  protected axios: AxiosInstance\r\n  protected objectFactory?: (data: any) => any\r\n\r\n  constructor(axios: AxiosInstance, ObjectConstructor?: { new (): any }) {\r\n    this.axios = axios\r\n\r\n    if (ObjectConstructor) {\r\n      this.objectFactory = (data: any) => {\r\n        if (Array.isArray(data)) {\r\n          data = data.map(item => {\r\n            const constructed = new ObjectConstructor()\r\n            return Object.assign(constructed, item)\r\n          })\r\n        } else {\r\n          const constructed = new ObjectConstructor()\r\n          data = Object.assign(constructed, data)\r\n        }\r\n        return data\r\n      }\r\n    }\r\n  }\r\n\r\n  protected wrapHydraItem(data: any): any & { $hydra: any } {\r\n    const $hydra: { [key: string]: any } = {}\r\n    for (const key of Object.keys(data)) {\r\n      if (key.startsWith('@') || (key.startsWith('hydra') && key !== 'hydra:member')) {\r\n        $hydra[key] = data[key]\r\n        delete data[key]\r\n      }\r\n    }\r\n    if ($hydra['@type'] === 'hydra:Collection') {\r\n      data = data['hydra:member']\r\n      for (const key of Object.keys(data)) {\r\n        data[key] = this.wrapHydraItem(data[key])\r\n      }\r\n    }\r\n    data.$hydra = $hydra\r\n    return data\r\n  }\r\n\r\n  protected wrapPromise(axiosPromise: AxiosPromise, objectFactory?: (data: any) => any) {\r\n    return new Promise((resolve, reject) => {\r\n      axiosPromise\r\n        .then((axiosResponse: AxiosResponse) => {\r\n          let data = axiosResponse.data\r\n          if (typeof data === 'object') {\r\n            data = this.wrapHydraItem(data)\r\n\r\n            if (!objectFactory) {\r\n              objectFactory = this.objectFactory\r\n            }\r\n\r\n            if (objectFactory) {\r\n              data = objectFactory(data)\r\n              axiosResponse.data = data\r\n            }\r\n\r\n            data.$axios = axiosResponse\r\n            delete data.$axios.data\r\n\r\n            const headers = axiosResponse.headers\r\n\r\n            if (\r\n              'pagination-page' in headers ||\r\n              'pagination-itemsperpage' in headers ||\r\n              'pagination-itemstotalcount' in headers\r\n            ) {\r\n              data.$page = {\r\n                page: parseInt(headers['pagination-page'], 10),\r\n                itemsPerPage: parseInt(headers['pagination-itemsperpage'], 10),\r\n                itemsTotalCount: parseInt(headers['pagination-itemstotalcount'], 10)\r\n              }\r\n            }\r\n\r\n            resolve(data)\r\n          } else {\r\n            resolve(axiosResponse.data)\r\n          }\r\n        })\r\n        .catch(reject)\r\n    })\r\n  }\r\n}\r\n","import AbstractResource from './AbstractResource'\r\nimport createPropsParams from '../function/createPropsParams'\r\nimport AxiosResponseExt from '../model/AxiosResponseExt'\r\nimport { AxiosRequestConfig } from 'axios'\r\nimport moment from 'moment'\r\nimport GetOptions from '../model/GetOptions'\r\nimport GetOneOptions from '../model/GetOneOptions'\r\n\r\nexport default abstract class AbstractApiResource<\r\n  ResponseType,\r\n  InputType = Partial<ResponseType>\r\n> extends AbstractResource {\r\n  abstract readonly prefix: string\r\n\r\n  private loadProps(params: string[], options: GetOneOptions) {\r\n    if (options.props) {\r\n      params.push(createPropsParams(options.props))\r\n    }\r\n  }\r\n\r\n  private buildSearch(\r\n    field: string,\r\n    query: string | number,\r\n    type: string | undefined,\r\n    isArray: boolean = false\r\n  ) {\r\n    if (type) {\r\n      return `${field}[${type}]=${query}`\r\n    }\r\n    if (isArray) {\r\n      return `${field}[]=${query}`\r\n    }\r\n    return `${field}=${query}`\r\n  }\r\n\r\n  private loadSearches(params: string[], options: GetOptions) {\r\n    if (options.searches) {\r\n      for (const search of options.searches) {\r\n        if (Array.isArray(search.query)) {\r\n          search.query.forEach((item: string | number) => {\r\n            params.push(this.buildSearch(search.field, item, search.type, true))\r\n          })\r\n        } else {\r\n          params.push(this.buildSearch(search.field, search.query, search.type))\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private loadSort(params: string[], options: GetOptions) {\r\n    if (options.sort) {\r\n      params.push(`order[${options.sort.field}]=${options.sort.desc ? 'desc' : 'asc'}`)\r\n    }\r\n  }\r\n\r\n  private loadPage(params: string[], options: GetOptions) {\r\n    if (options.page) {\r\n      params.push('pagination=true')\r\n      if (options.page.page) {\r\n        params.push(`page=${options.page.page}`)\r\n      }\r\n      if (options.page.itemsPerPage) {\r\n        params.push(`itemsPerPage=${options.page.itemsPerPage}`)\r\n      }\r\n    } else {\r\n      params.push('pagination=false')\r\n    }\r\n  }\r\n\r\n  private buildParams(options?: GetOptions | GetOneOptions): string[] {\r\n    const params: string[] = []\r\n\r\n    if (!options) options = {}\r\n\r\n    this.loadProps(params, options)\r\n    this.loadSearches(params, options)\r\n    this.loadSort(params, options)\r\n    this.loadPage(params, options)\r\n\r\n    return params\r\n  }\r\n\r\n  private buildUrl(path: string, options?: GetOptions | GetOneOptions): string {\r\n    const params = this.buildParams(options)\r\n\r\n    // TODO: Les paramètres peuvent être pasés proprement dans AXIOS !\r\n    return params && params.length > 0 ? `${path}?${params.join('&')}` : path\r\n  }\r\n\r\n  private preProcessData(item: any): any {\r\n    Object.keys(item).forEach(key => {\r\n      if (item[key] instanceof Date) {\r\n        const date = moment(item[key])\r\n        item[key] = date.format('YYYY-MM-DD HH:mm:ss')\r\n      }\r\n    })\r\n    return item\r\n  }\r\n\r\n  async count<GetResponseType = ResponseType>(\r\n    options?: GetOptions\r\n  ): Promise<number & AxiosResponseExt> {\r\n    const numberOfResultOptions: GetOptions = {\r\n      ...options,\r\n      ...{\r\n        page: {\r\n          page: 1,\r\n          itemsPerPage: 1\r\n        }\r\n      }\r\n    }\r\n    const getNumberOfResults = await this.get(numberOfResultOptions)\r\n    return getNumberOfResults.$hydra['hydra:totalItems']\r\n  }\r\n\r\n  async getAll<GetResponseType = ResponseType>(\r\n    options?: GetOptions\r\n  ): Promise<GetResponseType[] & AxiosResponseExt> {\r\n    return this.get(options)\r\n  }\r\n\r\n  get<GetResponseType = ResponseType>(\r\n    options?: GetOptions\r\n  ): Promise<GetResponseType[] & AxiosResponseExt> {\r\n    const url = this.buildUrl(this.prefix, options)\r\n    const axiosConfig = options ? options.axiosConfig : undefined\r\n\r\n    const promise = this.wrapPromise(this.axios.get(url, axiosConfig))\r\n    return promise as Promise<GetResponseType[] & AxiosResponseExt>\r\n  }\r\n\r\n  getOne<GetResponseType = ResponseType>(\r\n    id: number | string,\r\n    options?: GetOneOptions\r\n  ): Promise<GetResponseType & AxiosResponseExt> {\r\n    const url = this.buildUrl(`${this.prefix}/${id}`, options)\r\n    const axiosConfig = options ? options.axiosConfig : undefined\r\n\r\n    const promise = this.wrapPromise(this.axios.get(url, axiosConfig))\r\n    return promise as Promise<GetResponseType & AxiosResponseExt>\r\n  }\r\n\r\n  post<PostInputType = InputType, PostResponseType = ResponseType>(\r\n    item: PostInputType,\r\n    options?: GetOneOptions\r\n  ): Promise<PostResponseType & AxiosResponseExt> {\r\n    const url = this.buildUrl(this.prefix, options)\r\n    const axiosConfig = options ? options.axiosConfig : undefined\r\n\r\n    const promise = this.wrapPromise(this.axios.post(url, this.preProcessData(item), axiosConfig))\r\n    return promise as Promise<PostResponseType & AxiosResponseExt>\r\n  }\r\n\r\n  delete<DeleteResponseType = ResponseType>(\r\n    id: number | string,\r\n    options?: GetOneOptions\r\n  ): Promise<ResponseType & AxiosResponseExt> {\r\n    const url = this.buildUrl(`${this.prefix}/${id}`, options)\r\n    const axiosConfig = options ? options.axiosConfig : undefined\r\n\r\n    const promise = this.wrapPromise(this.axios.delete(url, axiosConfig))\r\n    return promise as Promise<ResponseType & AxiosResponseExt>\r\n  }\r\n\r\n  put<PutInputType = InputType, PutResponseType = ResponseType>(\r\n    id: number | string,\r\n    item: PutInputType,\r\n    options?: GetOneOptions\r\n  ): Promise<PutResponseType & AxiosResponseExt> {\r\n    const url = this.buildUrl(`${this.prefix}/${id}`, options)\r\n    const axiosConfig = options ? options.axiosConfig : undefined\r\n\r\n    const promise = this.wrapPromise(this.axios.put(url, this.preProcessData(item), axiosConfig))\r\n    return promise as Promise<PutResponseType & AxiosResponseExt>\r\n  }\r\n\r\n  patch<PatchInputType = InputType, PatchResponseType = ResponseType>(\r\n    id: number | string,\r\n    item: PatchInputType,\r\n    options?: GetOneOptions\r\n  ): Promise<PatchResponseType & AxiosResponseExt> {\r\n    const url = this.buildUrl(`${this.prefix}/${id}`, options)\r\n    const axiosConfig =\r\n      options && options.axiosConfig ? options.axiosConfig : ({} as AxiosRequestConfig)\r\n\r\n    if (!axiosConfig.headers) {\r\n      axiosConfig.headers = {}\r\n    }\r\n\r\n    if (!axiosConfig.headers['Content-Type']) {\r\n      axiosConfig.headers['Content-Type'] = 'application/merge-patch+json'\r\n    }\r\n\r\n    const promise = this.wrapPromise(this.axios.patch(url, this.preProcessData(item), axiosConfig))\r\n    return promise as Promise<PatchResponseType & AxiosResponseExt>\r\n  }\r\n}\r\n","import { AxiosInstance, CancelTokenSource } from 'axios'\r\nimport AbstractResource from './AbstractResource'\r\nimport AxiosResponseExt from '../model/AxiosResponseExt'\r\n\r\nexport default abstract class AbstractGetEntityResource<T, K> extends AbstractResource {\r\n  private prefix: string\r\n\r\n  constructor(axios: AxiosInstance, prefix: string) {\r\n    super(axios)\r\n    this.prefix = prefix\r\n  }\r\n\r\n  getPath(id?: K): string {\r\n    if (id === undefined) {\r\n      return this.prefix\r\n    } else {\r\n      const idPath = this.getIdPathRepresentation(id)\r\n      return `${this.prefix}/${idPath}`\r\n    }\r\n  }\r\n\r\n  getIdPathRepresentation(id: K): string {\r\n    return '' + id\r\n  }\r\n\r\n  get(id: K, cancelTokenSource?: CancelTokenSource): Promise<T & AxiosResponseExt> {\r\n    const path = this.getPath(id)\r\n    const cancelOptions = cancelTokenSource ? { cancelToken: cancelTokenSource.token } : undefined\r\n    const promise = this.wrapPromise(this.axios.get(path, cancelOptions))\r\n    return promise as Promise<T & AxiosResponseExt>\r\n  }\r\n}\r\n","import { CancelTokenSource } from 'axios'\r\nimport AbstractGetEntityResource from './AbstractGetEntityResource'\r\nimport AxiosResponseExt from '../model/AxiosResponseExt'\r\n\r\nexport default abstract class AbstractEntityResource<T, K> extends AbstractGetEntityResource<T, K> {\r\n  abstract getObjectId(object: T): K\r\n\r\n  getPathFromObject(object?: T) {\r\n    if (object === undefined) {\r\n      return this.getPath()\r\n    } else {\r\n      const id = this.getObjectId(object)\r\n      return this.getPath(id)\r\n    }\r\n  }\r\n\r\n  getFromObject(object: T): Promise<T & AxiosResponseExt> {\r\n    return this.get(this.getObjectId(object))\r\n  }\r\n\r\n  list(cancelTokenSource?: CancelTokenSource): Promise<T[] & AxiosResponseExt> {\r\n    const cancelOptions = cancelTokenSource ? { cancelToken: cancelTokenSource.token } : undefined\r\n    const promise = this.wrapPromise(this.axios.get(this.getPath(), cancelOptions))\r\n    return promise as Promise<T[] & AxiosResponseExt>\r\n  }\r\n\r\n  create(object: T): Promise<T & AxiosResponseExt> {\r\n    return this.wrapPromise(this.axios.post(this.getPath(), object)) as Promise<\r\n      T & AxiosResponseExt\r\n    >\r\n  }\r\n\r\n  deleteFromObject(object: T): Promise<T & AxiosResponseExt> {\r\n    return this.delete(this.getObjectId(object))\r\n  }\r\n\r\n  delete(id: K): Promise<T & AxiosResponseExt> {\r\n    const path = this.getPath(id)\r\n    return this.wrapPromise(this.axios.delete(path)) as Promise<T & AxiosResponseExt>\r\n  }\r\n\r\n  update(object: T): Promise<T & AxiosResponseExt> {\r\n    const path = this.getPathFromObject(object)\r\n    return this.wrapPromise(this.axios.put(path, object)) as Promise<T & AxiosResponseExt>\r\n  }\r\n}\r\n","import IdData from '../model/IdData'\r\nimport AbstractEntityResource from './AbstractEntityResource'\r\n\r\nexport default abstract class AbstractDataResource<\r\n  T extends IdData<any>\r\n> extends AbstractEntityResource<T, string> {\r\n  getObjectId(object: T): string {\r\n    return object.id\r\n  }\r\n}\r\n","import { AxiosInstance } from 'axios'\r\nimport IdData from '../model/IdData'\r\nimport AbstractDataResource from './AbstractDataResource'\r\n\r\nexport default class DefaultDataResource<T extends IdData<any>> extends AbstractDataResource<T> {\r\n  constructor(axios: AxiosInstance, dataName: string) {\r\n    super(axios, dataName)\r\n  }\r\n}\r\n","// Expose all models\nimport AbstractData from './model/AbstractData'\nimport ApiSearch from './model/ApiSearch'\nimport ApiSort from './model/ApiSort'\nimport AxiosResponseExt from './model/AxiosResponseExt'\nimport GetOneOptions from './model/GetOneOptions'\nimport GetOptions from './model/GetOptions'\nimport IdData from './model/IdData'\nimport Message from './model/Message'\nimport Page from './model/Page'\n// Expose all functions\nimport configureCancel from './function/configureCancel'\nimport configurePage from './function/configurePage'\nimport createPropsParams from './function/createPropsParams'\n// Expose all resouces\nimport AbstractApiResource from './resource/AbstractApiResource'\nimport AbstractDataResource from './resource/AbstractDataResource'\nimport AbstractEntityResource from './resource/AbstractEntityResource'\nimport AbstractGetEntityResource from './resource/AbstractGetEntityResource'\nimport AbstractResource from './resource/AbstractResource'\nimport DefaultDataResource from './resource/DefaultDataResource'\n\nexport {\n  AbstractData,\n  ApiSearch,\n  ApiSort,\n  AxiosResponseExt,\n  GetOneOptions,\n  GetOptions,\n  IdData,\n  Message,\n  Page,\n  configureCancel,\n  configurePage,\n  createPropsParams,\n  AbstractApiResource,\n  AbstractDataResource,\n  AbstractEntityResource,\n  AbstractGetEntityResource,\n  AbstractResource,\n  DefaultDataResource\n}\n"],"names":[],"mappings":"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"}